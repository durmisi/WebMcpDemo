<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WebMCP Demo - Todo Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body class="bg-gray-100 text-gray-900 min-h-screen flex flex-col">
    <!-- HEADER -->
    <header class="bg-white border-b">
      <div class="max-w-5xl mx-auto py-4 flex items-center justify-between">
        <h1 class="text-2xl md:text-3xl font-bold tracking-tight">
          Todo Manager - WebMCP Demo
        </h1>

        <div
          id="webmcp-status"
          class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm bg-yellow-100 text-yellow-800"
        >
          <span class="w-2 h-2 bg-yellow-500 rounded-full animate-pulse"></span>
          Checking WebMCP support...
        </div>
      </div>
    </header>

    <!-- MAIN -->
    <main class="flex-1">
      <div class="max-w-6xl mx-auto px-4 py-8 md:py-12">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-start">
          <!-- LEFT COLUMN -->
          <div class="lg:col-span-2 flex flex-col gap-8">
            <!-- ADD TODO -->
            <section class="bg-white rounded-2xl shadow border p-4 md:p-6">
              <h2 class="text-xl font-bold mb-2 text-indigo-700">
                Add New Todo
              </h2>
              <form id="add-todo-form" class="flex flex-col gap-2">
                <!-- Quick Add Row -->
                <div class="flex items-center gap-2">
                  <input
                    type="text"
                    id="todo-title"
                    maxlength="80"
                    required
                    placeholder="Add a new todo..."
                    class="flex-1 border border-gray-300 rounded-lg px-3 py-1.5 focus:ring-2 focus:ring-indigo-500 focus:outline-none text-base"
                  />
                  <div class="relative w-36">
                    <select
                      id="todo-priority"
                      name="priority"
                      class="block w-full border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white shadow-sm transition-colors duration-150 appearance-none pr-8"
                    >
                      <option value="">No Priority</option>
                      <option value="low">üü¢ Low</option>
                      <option value="medium">üü° Medium</option>
                      <option value="high">üî¥ High</option>
                    </select>
                    <span
                      class="pointer-events-none absolute inset-y-0 right-2 flex items-center text-gray-400"
                    >
                      <svg
                        class="w-4 h-4"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          d="M19 9l-7 7-7-7"
                        />
                      </svg>
                    </span>
                  </div>
                  <script>
                    // Force 'Low' as default selected on load
                    document.addEventListener("DOMContentLoaded", function () {
                      var select = document.getElementById("todo-priority");
                      if (select) select.value = "low";
                    });
                  </script>
                  <button
                    id="expand-todo-form"
                    type="button"
                    class="text-gray-400 hover:text-indigo-600 p-1"
                    title="More options"
                    aria-label="Show more options"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      class="w-6 h-6"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <circle cx="12" cy="6" r="1.5" />
                      <circle cx="12" cy="12" r="1.5" />
                      <circle cx="12" cy="18" r="1.5" />
                    </svg>
                  </button>
                  <button
                    id="add-todo-button"
                    type="submit"
                    disabled
                    class="bg-indigo-600 text-white px-4 py-1.5 rounded-lg font-semibold shadow hover:bg-indigo-700 transition disabled:opacity-40"
                    title="Add Todo"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke-width="2"
                      stroke="currentColor"
                      class="w-5 h-5"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M12 4.5v15m7.5-7.5h-15"
                      />
                    </svg>
                  </button>
                </div>
                <!-- Expandable Advanced Fields -->
                <div
                  id="advanced-fields"
                  class="hidden flex-col gap-2 animate-fade-in"
                >
                  <textarea
                    id="todo-content"
                    maxlength="200"
                    placeholder="Description (optional)"
                    class="w-full border border-gray-300 rounded-lg px-3 py-1.5 min-h-[60px] resize-vertical focus:ring-2 focus:ring-indigo-500 focus:outline-none text-base"
                  ></textarea>
                  <div class="flex justify-between text-xs text-gray-400 mt-1">
                    <span id="content-count">0/200</span>
                    <span>Keep it short & actionable</span>
                  </div>
                </div>
              </form>
              <script>
                // Expand/collapse advanced fields
                document.addEventListener("DOMContentLoaded", function () {
                  const expandBtn = document.getElementById("expand-todo-form");
                  const advFields = document.getElementById("advanced-fields");
                  if (expandBtn && advFields) {
                    expandBtn.addEventListener("click", function () {
                      advFields.classList.toggle("hidden");
                    });
                  }
                  // Optionally, expand on input focus
                  const titleInput = document.getElementById("todo-title");
                  titleInput.addEventListener("focus", function () {
                    advFields.classList.remove("hidden");
                  });
                });
              </script>
            </section>

            <!-- TODOS LIST -->
            <section class="bg-white rounded-2xl shadow border p-6 md:p-8 mt-4">
              <div
                class="flex flex-col md:flex-row md:justify-between md:items-center mb-6 gap-2"
              >
                <h2 class="text-2xl font-bold text-indigo-700">
                  Todos
                  <span
                    id="todo-count"
                    class="ml-2 text-sm text-gray-500 font-normal"
                    >(0)</span
                  >
                </h2>

                <input
                  type="text"
                  id="search-input"
                  placeholder="Search..."
                  class="border border-gray-300 rounded-lg px-4 py-2 w-full md:w-56 focus:ring-2 focus:ring-indigo-500 focus:outline-none"
                />
              </div>

              <div id="todos-list" class="space-y-3">
                <div class="text-center text-gray-500 py-12">
                  <div class="text-4xl mb-3">üìù</div>
                  <p class="font-medium text-gray-500">No todos yet.</p>
                  <p class="text-sm text-gray-400 mt-1">
                    Add one above or let an AI agent create one via WebMCP.
                  </p>
                </div>
              </div>
            </section>
          </div>

          <!-- RIGHT COLUMN -->
          <div class="lg:col-span-1">
            <section
              class="bg-white rounded-2xl shadow border p-6 md:p-8 sticky top-8"
            >
              <h2 class="text-2xl font-bold mb-4 text-indigo-700">
                WebMCP Tool Call Log
              </h2>
              <div
                id="tool-log"
                class="bg-gray-50 border rounded-lg p-4 max-h-[500px] overflow-y-auto font-mono text-sm"
              >
                <p class="text-gray-500">
                  Tool calls from AI agents will appear here...
                </p>
              </div>
            </section>
          </div>
        </div>
      </div>
    </main>

    <!-- FOOTER -->
    <footer class="bg-white border-t mt-10">
      <div class="max-w-5xl mx-auto px-6 py-6 text-sm text-gray-500 space-y-2">
        <p>
          Exposes tools:
          <code>add_todo</code>, <code>list_todos</code>,
          <code>search_todos</code>, <code>mark_todo_complete</code>,
          <code>delete_todo</code>,
          <code>get_todo_stats</code>
        </p>
        <p>
          Enable <strong>chrome://flags/#web-mcp</strong> in Chrome Canary 146+
        </p>
      </div>
    </footer>
    <script src="app.js"></script>
  </body>
</html>
